<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>GPTK: src/gaussian_processes/PSGP.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.6 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
    </ul>
  </div>
<h1>src/gaussian_processes/PSGP.h</h1><a href="PSGP_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/***************************************************************************</span>
<a name="l00002"></a>00002 <span class="comment"> *   AstonGeostats, algorithms for low-rank geostatistical models          *</span>
<a name="l00003"></a>00003 <span class="comment"> *                                                                         *</span>
<a name="l00004"></a>00004 <span class="comment"> *   Copyright (C) Remi Barillec, Ben Ingram, 2008-2009                    *</span>
<a name="l00005"></a>00005 <span class="comment"> *                                                                         *</span>
<a name="l00006"></a>00006 <span class="comment"> *   Remi Barillec, r.barillec@aston.ac.uk</span>
<a name="l00007"></a>00007 <span class="comment"> *   Ben Ingram, IngramBR@Aston.ac.uk                                      *</span>
<a name="l00008"></a>00008 <span class="comment"> *   Neural Computing Research Group,                                      *</span>
<a name="l00009"></a>00009 <span class="comment"> *   Aston University,                                                     *</span>
<a name="l00010"></a>00010 <span class="comment"> *   Aston Street, Aston Triangle,                                         *</span>
<a name="l00011"></a>00011 <span class="comment"> *   Birmingham. B4 7ET.                                                   *</span>
<a name="l00012"></a>00012 <span class="comment"> *   United Kingdom                                                        *</span>
<a name="l00013"></a>00013 <span class="comment"> *                                                                         *</span>
<a name="l00014"></a>00014 <span class="comment"> *   This program is free software; you can redistribute it and/or modify  *</span>
<a name="l00015"></a>00015 <span class="comment"> *   it under the terms of the GNU General Public License as published by  *</span>
<a name="l00016"></a>00016 <span class="comment"> *   the Free Software Foundation; either version 2 of the License, or     *</span>
<a name="l00017"></a>00017 <span class="comment"> *   (at your option) any later version.                                   *</span>
<a name="l00018"></a>00018 <span class="comment"> *                                                                         *</span>
<a name="l00019"></a>00019 <span class="comment"> *   This program is distributed in the hope that it will be useful,       *</span>
<a name="l00020"></a>00020 <span class="comment"> *   but WITHOUT ANY WARRANTY; without even the implied warranty of        *</span>
<a name="l00021"></a>00021 <span class="comment"> *   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the         *</span>
<a name="l00022"></a>00022 <span class="comment"> *   GNU General Public License for more details.                          *</span>
<a name="l00023"></a>00023 <span class="comment"> *                                                                         *</span>
<a name="l00024"></a>00024 <span class="comment"> *   You should have received a copy of the GNU General Public License     *</span>
<a name="l00025"></a>00025 <span class="comment"> *   along with this program; if not, write to the                         *</span>
<a name="l00026"></a>00026 <span class="comment"> *   Free Software Foundation, Inc.,                                       *</span>
<a name="l00027"></a>00027 <span class="comment"> *   59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.             *</span>
<a name="l00028"></a>00028 <span class="comment"> ***************************************************************************/</span>
<a name="l00029"></a>00029 
<a name="l00030"></a>00030 <span class="preprocessor">#ifndef PSGP_H_</span>
<a name="l00031"></a>00031 <span class="preprocessor"></span><span class="preprocessor">#define PSGP_H_</span>
<a name="l00032"></a>00032 <span class="preprocessor"></span>
<a name="l00033"></a>00033 <span class="preprocessor">#include &lt;itpp/itbase.h&gt;</span>
<a name="l00034"></a>00034 
<a name="l00035"></a>00035 <span class="preprocessor">#include "<a class="code" href="ForwardModel_8h.html">ForwardModel.h</a>"</span>
<a name="l00036"></a>00036 <span class="preprocessor">#include "<a class="code" href="Optimisable_8h.html">optimisation/Optimisable.h</a>"</span>
<a name="l00037"></a>00037 <span class="preprocessor">#include "<a class="code" href="CovarianceFunction_8h.html">covariance_functions/CovarianceFunction.h</a>"</span>
<a name="l00038"></a>00038 <span class="preprocessor">#include "<a class="code" href="LikelihoodType_8h.html">likelihood_models/LikelihoodType.h</a>"</span>
<a name="l00039"></a>00039 <span class="preprocessor">#include "<a class="code" href="itppext_8h.html">itppext/itppext.h</a>"</span>
<a name="l00040"></a>00040 
<a name="l00041"></a>00041 <span class="preprocessor">#include &lt;cassert&gt;</span>
<a name="l00042"></a>00042 
<a name="l00043"></a><a class="code" href="PSGP_8h.html#b80013b45e5c9a06195d2c7ac2861c0b">00043</a> <span class="preprocessor">#define LAMBDA_TOLERANCE 1e-10</span>
<a name="l00044"></a>00044 <span class="preprocessor"></span>
<a name="l00045"></a>00045 <span class="keyword">using namespace </span>std;
<a name="l00046"></a>00046 <span class="keyword">using namespace </span>itpp;
<a name="l00047"></a>00047 
<a name="l00048"></a>00048 <span class="preprocessor">#ifndef SEQUENTIALGP_H_</span>
<a name="l00049"></a><a class="code" href="PSGP_8h.html#b8070693104b4577c11a1c4e7573e2ca">00049</a> <span class="preprocessor"></span>    <span class="keyword">enum</span> <a class="code" href="PSGP_8h.html#b8070693104b4577c11a1c4e7573e2ca">ScoringMethod</a> { <a class="code" href="PSGP_8h.html#b8070693104b4577c11a1c4e7573e2ca46d8d47701b60203d023c1c14c87e3a2">Geometric</a>, <a class="code" href="PSGP_8h.html#b8070693104b4577c11a1c4e7573e2caac7a084b670ac82ebc59b8b13f0b0acd">MeanComponent</a>, <a class="code" href="PSGP_8h.html#b8070693104b4577c11a1c4e7573e2cac6dd2c2e8e6eca92429930c23e02568d">FullKL</a> };
<a name="l00050"></a><a class="code" href="PSGP_8h.html#87336fb9c316426ffe874800d805be276962c4e86a370d11afa6d87fee7d5bb1">00050</a>     <span class="keyword">enum</span> <a class="code" href="PSGP_8h.html#87336fb9c316426ffe874800d805be27">LikelihoodCalculation</a> { <a class="code" href="PSGP_8h.html#87336fb9c316426ffe874800d805be2716289b9d5c624c0633953ad961130a6f">FullEvid</a>, <a class="code" href="PSGP_8h.html#87336fb9c316426ffe874800d805be27b2dc008e700872af7621b36b24fb90b7">Approximate</a>, <a class="code" href="PSGP_8h.html#87336fb9c316426ffe874800d805be276962c4e86a370d11afa6d87fee7d5bb1">UpperBound</a> };
<a name="l00051"></a>00051 <span class="preprocessor">#endif</span>
<a name="l00052"></a>00052 <span class="preprocessor"></span>    
<a name="l00053"></a>00053 <span class="comment">// We went through 3 implementations of the algorithm as we optimised it. </span>
<a name="l00054"></a>00054 <span class="comment">// Although we could have left the latest version only (V3) as it is the</span>
<a name="l00055"></a>00055 <span class="comment">// fastest/most memory efficient, we have left the previous versions </span>
<a name="l00056"></a>00056 <span class="comment">// for debugging purposes. These flags correspond to the 3 implementations</span>
<a name="l00057"></a>00057 <span class="comment">// of the algorith, V1 being the oldest (and least efficient) and V3</span>
<a name="l00058"></a>00058 <span class="comment">// the newest (and most efficient). V3 is used by default.</span>
<a name="l00059"></a><a class="code" href="PSGP_8h.html#0c66acd3b3fe7c466bc6285126f99d98">00059</a> <span class="keyword">enum</span> <a class="code" href="PSGP_8h.html#0c66acd3b3fe7c466bc6285126f99d98">AlgoVersion</a> { <a class="code" href="PSGP_8h.html#0c66acd3b3fe7c466bc6285126f99d98b017f541f880aa306d6b087817d7d24c">ALGO_V1</a>, <a class="code" href="PSGP_8h.html#0c66acd3b3fe7c466bc6285126f99d989e0b6a5edcd142c1f68370fe2499e7c9">ALGO_V2</a>, <a class="code" href="PSGP_8h.html#0c66acd3b3fe7c466bc6285126f99d98307d9580a9b5615a81ba2dff100d9935">ALGO_V3</a> };
<a name="l00060"></a>00060     
<a name="l00061"></a><a class="code" href="classPSGP.html">00061</a> <span class="keyword">class </span><a class="code" href="classPSGP.html">PSGP</a> : <span class="keyword">public</span> <a class="code" href="classForwardModel.html">ForwardModel</a>, <span class="keyword">public</span> <a class="code" href="classOptimisable.html">Optimisable</a>
<a name="l00062"></a>00062 {
<a name="l00063"></a>00063 <span class="keyword">public</span>:
<a name="l00064"></a>00064     <a class="code" href="classPSGP.html#d64fa796a72b900687911307b638fd32">PSGP</a>(mat&amp; X, vec&amp; Y, <a class="code" href="classCovarianceFunction.html">CovarianceFunction</a>&amp; cf, <span class="keywordtype">int</span> nActivePoints=400, <span class="keywordtype">int</span> _iterChanging=1, <span class="keywordtype">int</span> _iterFixed=2);
<a name="l00065"></a>00065         <span class="keyword">virtual</span> <a class="code" href="classPSGP.html#b37433c3ab9d76d31ffac55cf38d99fa">~PSGP</a>();
<a name="l00066"></a>00066 
<a name="l00067"></a>00067         <span class="keywordtype">void</span> <a class="code" href="classPSGP.html#00b161338e7383b34afd818ffe3eb856">computePosterior</a>(<span class="keyword">const</span> <a class="code" href="classLikelihoodType.html">LikelihoodType</a>&amp; noiseModel);
<a name="l00068"></a>00068         <span class="keywordtype">void</span> <a class="code" href="classPSGP.html#00b161338e7383b34afd818ffe3eb856">computePosterior</a>(<span class="keyword">const</span> ivec&amp; LikelihoodModel, <span class="keyword">const</span> Vec&lt;LikelihoodType *&gt; noiseModels);
<a name="l00069"></a>00069         <span class="keywordtype">void</span> <a class="code" href="classPSGP.html#f522f5346425faf52c395471115eb468">resetPosterior</a>();
<a name="l00070"></a>00070         <span class="keywordtype">void</span> <a class="code" href="classPSGP.html#28acfbdc97a01f2cd34da802877ff13c">recomputePosterior</a>();
<a name="l00071"></a>00071         
<a name="l00072"></a>00072         <span class="keywordtype">void</span> <a class="code" href="classPSGP.html#863043645790dd087fc69eab3db7cb5e">computePosteriorFixedActiveSet</a>(<span class="keyword">const</span> <a class="code" href="classLikelihoodType.html">LikelihoodType</a>&amp; noiseModel, ivec iActive);
<a name="l00073"></a>00073         <span class="keywordtype">void</span> <a class="code" href="classPSGP.html#ae78f8da0e6631b03140eaf996f2a916">recomputePosteriorFixedActiveSet</a>(<span class="keyword">const</span> <a class="code" href="classLikelihoodType.html">LikelihoodType</a>&amp; noiseModel);
<a name="l00074"></a>00074         
<a name="l00081"></a>00081         <span class="keywordtype">void</span> <a class="code" href="classPSGP.html#dd5c54c948b6f2d0b18369b36dd19fd0">makePredictions</a>(vec&amp; Mean, vec&amp; Variance, <span class="keyword">const</span> mat&amp; Xpred, <a class="code" href="classCovarianceFunction.html">CovarianceFunction</a> &amp;cf) <span class="keyword">const</span>;
<a name="l00082"></a>00082         <span class="keywordtype">void</span> <a class="code" href="classPSGP.html#dd5c54c948b6f2d0b18369b36dd19fd0">makePredictions</a>(vec&amp; Mean, vec&amp; Variance, <span class="keyword">const</span> mat&amp; Xpred) <span class="keyword">const</span>;
<a name="l00083"></a>00083         
<a name="l00084"></a>00084         
<a name="l00085"></a><a class="code" href="classPSGP.html#da7d350730d52831120c9d23c9dd0e03">00085</a>         <span class="keywordtype">void</span> <a class="code" href="classPSGP.html#da7d350730d52831120c9d23c9dd0e03">setAlgoVersion</a>(<a class="code" href="PSGP_8h.html#0c66acd3b3fe7c466bc6285126f99d98">AlgoVersion</a> version) { <a class="code" href="classPSGP.html#1001ca2d50d9c7e6b5e4cf026eb66b2c">algoVersion</a> = version; }
<a name="l00086"></a><a class="code" href="classPSGP.html#cefcfc7af5e2034b2b456dd86b11b089">00086</a>         <span class="keywordtype">void</span> <a class="code" href="classPSGP.html#cefcfc7af5e2034b2b456dd86b11b089">setGammaTolerance</a>(<span class="keywordtype">double</span> gammaMin) { <a class="code" href="classPSGP.html#82b293c7ddbbb4aec961dc0272056688">gammaTolerance</a> = gammaMin; }
<a name="l00087"></a>00087         
<a name="l00088"></a>00088         vec <a class="code" href="classPSGP.html#97d9a80a9e4117e4f4cc08c1bfbe6a0d">simulate</a>(<span class="keyword">const</span> mat&amp; Xpred, <span class="keywordtype">bool</span> approx) <span class="keyword">const</span>;
<a name="l00089"></a>00089 
<a name="l00090"></a>00090         <span class="comment">// Set/Get/Print methods for covariance parameters</span>
<a name="l00091"></a>00091         vec  <a class="code" href="classPSGP.html#eaf8dcf2326faec2b6c98109b9d5ea9b">getTransformedParameters</a>() <span class="keyword">const</span>;
<a name="l00092"></a>00092         <span class="keywordtype">void</span> <a class="code" href="classPSGP.html#440dda9cdf8837790379bc6de1f9612f">setTransformedParameters</a>(<span class="keyword">const</span> vec p);
<a name="l00093"></a>00093         <span class="keywordtype">void</span> <a class="code" href="classPSGP.html#8d03e7a72d9e8a5f5216fa5c1a0290bc">displayModelParameters</a>() <span class="keyword">const</span>;
<a name="l00094"></a>00094 
<a name="l00095"></a>00095         <span class="comment">// Optimisation function</span>
<a name="l00096"></a>00096         <span class="keywordtype">double</span> <a class="code" href="classPSGP.html#f623c7d8660f7c414c6584a60ef15814">objective</a>() <span class="keyword">const</span>;
<a name="l00097"></a>00097         vec    <a class="code" href="classPSGP.html#a31b08e9eba0af48a0c8323867588e0b">gradient</a>() <span class="keyword">const</span>;
<a name="l00098"></a>00098         
<a name="l00102"></a><a class="code" href="classPSGP.html#e228bd30911b4c38c321b208734af910">00102</a>         <span class="keywordtype">int</span>  <a class="code" href="classPSGP.html#e228bd30911b4c38c321b208734af910">getSizeActiveSet</a>()      { <span class="keywordflow">return</span> <a class="code" href="classPSGP.html#1550fe2abe0817712d6013ed031e9ade">sizeActiveSet</a>; }
<a name="l00103"></a><a class="code" href="classPSGP.html#fb800e5eadd44f724ef442b437e7040f">00103</a>         ivec <a class="code" href="classPSGP.html#fb800e5eadd44f724ef442b437e7040f">getActiveSetIndices</a>()   { <span class="keywordflow">return</span> <a class="code" href="classPSGP.html#96f08879d31c55c3bf2074b746a1ded4">idxActiveSet</a>; }
<a name="l00104"></a><a class="code" href="classPSGP.html#14a19bcb8a91684e73fdc8430b01fc11">00104</a>         mat  <a class="code" href="classPSGP.html#14a19bcb8a91684e73fdc8430b01fc11">getActiveSetLocations</a>() { <span class="keywordflow">return</span> <a class="code" href="classPSGP.html#cc89db6ccecc8ebcddeb89de5ecf41ab">ActiveSet</a>; }
<a name="l00105"></a><a class="code" href="classPSGP.html#c1c9738df9dfaa8174ca6560b5f7f8e2">00105</a>         vec  <a class="code" href="classPSGP.html#c1c9738df9dfaa8174ca6560b5f7f8e2">getActiveSetObservations</a>() { <span class="keywordflow">return</span> <a class="code" href="classPSGP.html#333f6393321bfacd68834a00ba96f6a5">Observations</a>(<a class="code" href="classPSGP.html#96f08879d31c55c3bf2074b746a1ded4">idxActiveSet</a>); }
<a name="l00106"></a>00106 
<a name="l00107"></a><a class="code" href="classPSGP.html#4512bd1f6e32a3dfc465e330d722e2c7">00107</a>         <span class="keywordtype">void</span> <a class="code" href="classPSGP.html#4512bd1f6e32a3dfc465e330d722e2c7">setActiveSetSize</a>(<span class="keywordtype">int</span> n) { <a class="code" href="classPSGP.html#7ecc8ee1c7b9a183208538a45f941f54">maxActiveSet</a> = n; }
<a name="l00108"></a>00108         <span class="keywordtype">void</span> <a class="code" href="classPSGP.html#51347d7c15ff9354a4aa897118c54027">setActiveSet</a>(ivec activeIndexes, mat activeLocations);
<a name="l00109"></a>00109         <span class="keywordtype">void</span> <a class="code" href="classPSGP.html#9f880968e2043b242835794df45b032b">setLikelihoodType</a>(<a class="code" href="PSGP_8h.html#87336fb9c316426ffe874800d805be27">LikelihoodCalculation</a> lc);
<a name="l00110"></a>00110         
<a name="l00111"></a>00111                 
<a name="l00112"></a>00112 <span class="keyword">private</span>:
<a name="l00113"></a>00113 
<a name="l00114"></a>00114     <span class="comment">// Version of the algorithm to use (should be V3, the </span>
<a name="l00115"></a>00115     <span class="comment">// latest and fastest) unless an older version is really needed</span>
<a name="l00116"></a>00116     <span class="comment">// (for backwards comparison/debugging)</span>
<a name="l00117"></a><a class="code" href="classPSGP.html#1001ca2d50d9c7e6b5e4cf026eb66b2c">00117</a>     <a class="code" href="PSGP_8h.html#0c66acd3b3fe7c466bc6285126f99d98">AlgoVersion</a> <a class="code" href="classPSGP.html#1001ca2d50d9c7e6b5e4cf026eb66b2c">algoVersion</a>;
<a name="l00118"></a>00118     
<a name="l00119"></a>00119     <span class="comment">// Inputs and outputs</span>
<a name="l00120"></a><a class="code" href="classPSGP.html#c24d0548549e3fa8e8b0026969c82654">00120</a>     mat&amp; <a class="code" href="classPSGP.html#c24d0548549e3fa8e8b0026969c82654">Locations</a>;
<a name="l00121"></a><a class="code" href="classPSGP.html#333f6393321bfacd68834a00ba96f6a5">00121</a>     vec&amp; <a class="code" href="classPSGP.html#333f6393321bfacd68834a00ba96f6a5">Observations</a>;
<a name="l00122"></a>00122     
<a name="l00123"></a><a class="code" href="classPSGP.html#61026630262c6c0d2512b18d12c8c204">00123</a>     <span class="keywordtype">int</span> <a class="code" href="classPSGP.html#61026630262c6c0d2512b18d12c8c204">nObs</a>;  <span class="comment">// Number of observations</span>
<a name="l00124"></a>00124     
<a name="l00125"></a>00125     <span class="comment">// Covariance function</span>
<a name="l00126"></a><a class="code" href="classPSGP.html#5e72c03e79ea7225b16a098e28ce6ad7">00126</a>     <a class="code" href="classCovarianceFunction.html">CovarianceFunction</a>&amp; <a class="code" href="classPSGP.html#5e72c03e79ea7225b16a098e28ce6ad7">covFunc</a>;
<a name="l00127"></a>00127     
<a name="l00128"></a><a class="code" href="classPSGP.html#1550fe2abe0817712d6013ed031e9ade">00128</a>     <span class="keywordtype">int</span>     <a class="code" href="classPSGP.html#1550fe2abe0817712d6013ed031e9ade">sizeActiveSet</a>;
<a name="l00129"></a><a class="code" href="classPSGP.html#7ecc8ee1c7b9a183208538a45f941f54">00129</a>     <span class="keywordtype">int</span>     <a class="code" href="classPSGP.html#7ecc8ee1c7b9a183208538a45f941f54">maxActiveSet</a>;
<a name="l00130"></a><a class="code" href="classPSGP.html#bbd9740bde7af5cbbc25fc05ad86da17">00130</a>     <span class="keywordtype">double</span>  <a class="code" href="classPSGP.html#bbd9740bde7af5cbbc25fc05ad86da17">epsilonTolerance</a>;
<a name="l00131"></a><a class="code" href="classPSGP.html#0124ec4facbbb7b59f2266bd2e62d760">00131</a>     <span class="keywordtype">bool</span>    <a class="code" href="classPSGP.html#0124ec4facbbb7b59f2266bd2e62d760">momentProjection</a>;
<a name="l00132"></a><a class="code" href="classPSGP.html#24db55d309da2d22031a82ddc51a882c">00132</a>     <span class="keywordtype">int</span>     <a class="code" href="classPSGP.html#24db55d309da2d22031a82ddc51a882c">iterChanging</a>;
<a name="l00133"></a><a class="code" href="classPSGP.html#02bbe60b2979a629e746f2a63d91d922">00133</a>     <span class="keywordtype">int</span>     <a class="code" href="classPSGP.html#02bbe60b2979a629e746f2a63d91d922">iterFixed</a>;
<a name="l00134"></a>00134     
<a name="l00135"></a>00135     <span class="comment">// Elements of computation</span>
<a name="l00136"></a><a class="code" href="classPSGP.html#c4e62fe652c732eca95d53fb1e1e8938">00136</a>     mat <a class="code" href="classPSGP.html#c4e62fe652c732eca95d53fb1e1e8938">KB</a>;             <span class="comment">// covariance between BV</span>
<a name="l00137"></a><a class="code" href="classPSGP.html#a59e3815553fee8b984e234d90d83d37">00137</a>     mat <a class="code" href="classPSGP.html#a59e3815553fee8b984e234d90d83d37">Q</a>;              <span class="comment">// inverse covariance between BV</span>
<a name="l00138"></a><a class="code" href="classPSGP.html#cf98a3926ff0c60b077bc26cebceb5c4">00138</a>     mat <a class="code" href="classPSGP.html#cf98a3926ff0c60b077bc26cebceb5c4">C</a>;              <span class="comment">// for calculating variance</span>
<a name="l00139"></a><a class="code" href="classPSGP.html#14dd149c39cca496dca1accc44829ca0">00139</a>     vec <a class="code" href="classPSGP.html#14dd149c39cca496dca1accc44829ca0">alpha</a>;          <span class="comment">// alphas for calculating mean</span>
<a name="l00140"></a>00140     
<a name="l00141"></a><a class="code" href="classPSGP.html#82b293c7ddbbb4aec961dc0272056688">00141</a>     <span class="keywordtype">double</span> <a class="code" href="classPSGP.html#82b293c7ddbbb4aec961dc0272056688">gammaTolerance</a>;  <span class="comment">// Threshold determining whether an observation is added to active set</span>
<a name="l00142"></a>00142 
<a name="l00143"></a><a class="code" href="classPSGP.html#cc89db6ccecc8ebcddeb89de5ecf41ab">00143</a>     mat     <a class="code" href="classPSGP.html#cc89db6ccecc8ebcddeb89de5ecf41ab">ActiveSet</a>;     <span class="comment">// Active set</span>
<a name="l00144"></a><a class="code" href="classPSGP.html#96f08879d31c55c3bf2074b746a1ded4">00144</a>     ivec    <a class="code" href="classPSGP.html#96f08879d31c55c3bf2074b746a1ded4">idxActiveSet</a>;  <span class="comment">// Indexes of observations in active set </span>
<a name="l00145"></a>00145 
<a name="l00146"></a><a class="code" href="classPSGP.html#f2b0ba2f9ee699954cd9e68a28aa1ec0">00146</a>     mat <a class="code" href="classPSGP.html#f2b0ba2f9ee699954cd9e68a28aa1ec0">P</a>;              <span class="comment">// projection coefficient matrix (full obs onto active set)</span>
<a name="l00147"></a><a class="code" href="classPSGP.html#c71c9a4482e3496e5d420e2508f6978d">00147</a>     vec <a class="code" href="classPSGP.html#c71c9a4482e3496e5d420e2508f6978d">meanEP</a>;         <span class="comment">// EP mean parameter (a)</span>
<a name="l00148"></a><a class="code" href="classPSGP.html#e0adc0ba901950dfda5d49e1e4aae96f">00148</a>     vec <a class="code" href="classPSGP.html#e0adc0ba901950dfda5d49e1e4aae96f">varEP</a>;          <span class="comment">// EP variance parameter(lambda)</span>
<a name="l00149"></a>00149     
<a name="l00150"></a><a class="code" href="classPSGP.html#22c7b0071717761bd119de71fd8c3ba0">00150</a>     vec <a class="code" href="classPSGP.html#22c7b0071717761bd119de71fd8c3ba0">logZ</a>;           <span class="comment">// log-evidence</span>
<a name="l00151"></a>00151 
<a name="l00152"></a>00152     <span class="comment">// Augmented matrices - When doing a full update, we add and remove points to </span>
<a name="l00153"></a>00153     <span class="comment">// the active set. This operation being expensive (it involves memory reallocations),</span>
<a name="l00154"></a>00154     <span class="comment">// it is more efficient to use temporary extended matrices for that purpose. These</span>
<a name="l00155"></a>00155     <span class="comment">// matrices correspond to having an active set with an extra point. Points are added</span>
<a name="l00156"></a>00156     <span class="comment">// to the extended matrices, and removed by swapping the relevant rows/columns with the</span>
<a name="l00157"></a>00157     <span class="comment">// actual matrices (KB, Q, C, ...)</span>
<a name="l00158"></a><a class="code" href="classPSGP.html#af21d9209bfc4cceb67de1834ae2deb5">00158</a>     mat <a class="code" href="classPSGP.html#af21d9209bfc4cceb67de1834ae2deb5">KB_aug</a>;
<a name="l00159"></a><a class="code" href="classPSGP.html#7acc2a8489369194f151e5154554584c">00159</a>     mat <a class="code" href="classPSGP.html#7acc2a8489369194f151e5154554584c">Q_aug</a>;
<a name="l00160"></a><a class="code" href="classPSGP.html#133965b2c84576498cfa6dc43a309602">00160</a>     mat <a class="code" href="classPSGP.html#133965b2c84576498cfa6dc43a309602">C_aug</a>;
<a name="l00161"></a><a class="code" href="classPSGP.html#2313aafdf9724cd25ae49a9a26d033b4">00161</a>     vec <a class="code" href="classPSGP.html#2313aafdf9724cd25ae49a9a26d033b4">alpha_aug</a>;
<a name="l00162"></a><a class="code" href="classPSGP.html#47bdcd5e86a8458ae6685eda00ae7b91">00162</a>     mat <a class="code" href="classPSGP.html#47bdcd5e86a8458ae6685eda00ae7b91">ActiveSet_aug</a>;
<a name="l00163"></a><a class="code" href="classPSGP.html#6e1e253936cd77f275915de6bac18112">00163</a>     ivec <a class="code" href="classPSGP.html#6e1e253936cd77f275915de6bac18112">idxActiveSet_aug</a>;
<a name="l00164"></a><a class="code" href="classPSGP.html#e37dc8cea9dd8bed27ae8d8a203c6a91">00164</a>     mat <a class="code" href="classPSGP.html#e37dc8cea9dd8bed27ae8d8a203c6a91">P_aug</a>;
<a name="l00165"></a>00165     
<a name="l00166"></a>00166     <span class="comment">// Augmented stuff - version 2: only store the changes, not the full matrices</span>
<a name="l00167"></a>00167     <span class="comment">// Modify the original ones instead.</span>
<a name="l00168"></a><a class="code" href="classPSGP.html#1be3a9b9b5dab57d3ded010f5a8f0590">00168</a>     <span class="keywordtype">int</span> <a class="code" href="classPSGP.html#1be3a9b9b5dab57d3ded010f5a8f0590">idxActiveSet_new</a>;         <span class="comment">// Index of the latest active point added to the set</span>
<a name="l00169"></a><a class="code" href="classPSGP.html#2a244813a9d6f05d6a0afaf938842220">00169</a>     vec <a class="code" href="classPSGP.html#2a244813a9d6f05d6a0afaf938842220">ActiveSet_new</a>;            <span class="comment">// The latest (extra) active point added to the set</span>
<a name="l00170"></a><a class="code" href="classPSGP.html#fb74bcc7cadee0da12806b7dd179dd83">00170</a>     vec <a class="code" href="classPSGP.html#fb74bcc7cadee0da12806b7dd179dd83">P_new</a>;                    <span class="comment">// The column of P for the latest active point</span>
<a name="l00171"></a><a class="code" href="classPSGP.html#61a557d043517adcfac6ff9a32a0ba65">00171</a>     vec <a class="code" href="classPSGP.html#61a557d043517adcfac6ff9a32a0ba65">KB_new</a>;                   <span class="comment">// The covariance btw new active point and older ones</span>
<a name="l00172"></a><a class="code" href="classPSGP.html#5ac99eb655a16bc48ec08684c5190bd8">00172</a>     <span class="keywordtype">double</span> <a class="code" href="classPSGP.html#5ac99eb655a16bc48ec08684c5190bd8">kb_new</a>;                <span class="comment">// The auto-covariance of the new active point </span>
<a name="l00173"></a><a class="code" href="classPSGP.html#419fe260308fcc210a63e27e8f8f48a0">00173</a>     vec <a class="code" href="classPSGP.html#419fe260308fcc210a63e27e8f8f48a0">Q_new</a>;                    <span class="comment">// The inverse cov btw new active point and older ones</span>
<a name="l00174"></a><a class="code" href="classPSGP.html#020efca4f40c8399f7c0022a3815079b">00174</a>     <span class="keywordtype">double</span> <a class="code" href="classPSGP.html#020efca4f40c8399f7c0022a3815079b">q_new</a>;                 <span class="comment">// The inverse auto-cov btw new active point and older ones</span>
<a name="l00175"></a><a class="code" href="classPSGP.html#ad9ff997952058283a42d8092d1a317d">00175</a>     <span class="keywordtype">double</span> <a class="code" href="classPSGP.html#ad9ff997952058283a42d8092d1a317d">alpha_new</a>;             <span class="comment">// Alpha for the latest active point</span>
<a name="l00176"></a><a class="code" href="classPSGP.html#05bd907428f5c956503aded32da393d3">00176</a>     vec <a class="code" href="classPSGP.html#05bd907428f5c956503aded32da393d3">C_new</a>;                    <span class="comment">// C btw latest active point and older ones</span>
<a name="l00177"></a><a class="code" href="classPSGP.html#be149d6a917ddb4df366208f1d3a18d9">00177</a>     <span class="keywordtype">double</span> <a class="code" href="classPSGP.html#be149d6a917ddb4df366208f1d3a18d9">c_new</a>;                 <span class="comment">// C btw latest active point and itself</span>
<a name="l00178"></a>00178 
<a name="l00179"></a>00179     
<a name="l00180"></a><a class="code" href="classPSGP.html#b1216c4b230ac46541ebf9d08a468c68">00180</a>     <a class="code" href="PSGP_8h.html#87336fb9c316426ffe874800d805be27">LikelihoodCalculation</a> <a class="code" href="classPSGP.html#b1216c4b230ac46541ebf9d08a468c68">likelihoodType</a>;
<a name="l00181"></a>00181     
<a name="l00182"></a>00182     
<a name="l00183"></a>00183     
<a name="l00184"></a>00184         <span class="comment">// These methods provide the core algorithm</span>
<a name="l00185"></a>00185     <span class="keywordtype">void</span> <a class="code" href="classPSGP.html#32f0e71a38137571f4143323febe2f4c">processObservationEP</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> iObs, <span class="keyword">const</span> <a class="code" href="classLikelihoodType.html">LikelihoodType</a> &amp;noiseModel, <span class="keyword">const</span> <span class="keywordtype">bool</span> fixActiveSet);
<a name="l00186"></a>00186     <span class="keywordtype">void</span> <a class="code" href="classPSGP.html#add198a6e7f72347b8232d6d65de7f74">EP_removePreviousContribution</a>(<span class="keywordtype">int</span> iObs);
<a name="l00187"></a>00187     <span class="keywordtype">void</span> <a class="code" href="classPSGP.html#51f93fb1f7c45ccfe92f806f23952389">EP_updateIntermediateComputations</a>(<span class="keywordtype">double</span> &amp;cavityMean, <span class="keywordtype">double</span> &amp;cavityVar, <span class="keywordtype">double</span> &amp;sigmaLoc,
<a name="l00188"></a>00188                                            vec &amp;k, <span class="keywordtype">double</span> &amp;gamma, vec &amp;eHat, vec loc);
<a name="l00189"></a>00189     <span class="keywordtype">void</span> <a class="code" href="classPSGP.html#1819a81365ec02fdf4c55a3a847fa99c">EP_updateEPParameters</a>(<span class="keywordtype">int</span> iObs, <span class="keywordtype">double</span> q, <span class="keywordtype">double</span> r, <span class="keywordtype">double</span> cavityMean, <span class="keywordtype">double</span> cavityVar, 
<a name="l00190"></a>00190                                <span class="keywordtype">double</span> logEvidence);
<a name="l00191"></a>00191     <span class="keywordtype">void</span> <a class="code" href="classPSGP.html#4205b0a7e94625e36b90cc3aa198cbd4">EP_removeCollapsedPoints</a>();
<a name="l00192"></a>00192     
<a name="l00193"></a>00193     <span class="comment">// ALGO_V1: Implementation of the add/remove active point, version 1</span>
<a name="l00194"></a>00194     <span class="keywordtype">void</span> <a class="code" href="classPSGP.html#0140168728ce911aa7908d0c109e6d4b">addActivePoint</a>(<span class="keywordtype">int</span> iObs, <span class="keywordtype">double</span> q, <span class="keywordtype">double</span> r, vec k, <span class="keywordtype">double</span> sigmaLoc, <span class="keywordtype">double</span> gamma, vec eHat);
<a name="l00195"></a>00195     <span class="keywordtype">void</span> <a class="code" href="classPSGP.html#6bc5a04877dbb0d9e421237bdb54204b">deleteActivePoint</a>(<span class="keywordtype">int</span> iObs);
<a name="l00196"></a>00196     
<a name="l00197"></a>00197     <span class="comment">// ALGO_V2: Implementation of the add/remove active point, version 2 (augmented matrices)</span>
<a name="l00198"></a>00198     <span class="keywordtype">void</span> <a class="code" href="classPSGP.html#24638799d17b547a12d135f6c0f1419f">addActivePointAugmented_v1</a>(<span class="keywordtype">int</span> iObs, <span class="keywordtype">double</span> q, <span class="keywordtype">double</span> r, vec k, <span class="keywordtype">double</span> sigmaLoc, <span class="keywordtype">double</span> gamma, vec eHat);
<a name="l00199"></a>00199     <span class="keywordtype">void</span> <a class="code" href="classPSGP.html#54c3f5c42a39f413cd857441d307d371">swapActivePoint_v1</a>(<span class="keywordtype">int</span> iObs);
<a name="l00200"></a>00200 
<a name="l00201"></a>00201     <span class="comment">// ALGO_V3: Implementation of the add/remove active point, version 3 (no augmented matrices)</span>
<a name="l00202"></a>00202     <span class="keywordtype">void</span> <a class="code" href="classPSGP.html#b0d10d5ac12a0239f1ce2ca3bdf3d444">addActivePointAugmented_v2</a>(<span class="keywordtype">int</span> iObs, <span class="keywordtype">double</span> q, <span class="keywordtype">double</span> r, vec k, <span class="keywordtype">double</span> sigmaLoc, <span class="keywordtype">double</span> gamma, vec eHat);
<a name="l00203"></a>00203     <span class="keywordtype">void</span> <a class="code" href="classPSGP.html#232ed39d0002aad3219a5fb9e8cc5725">swapActivePoint_v2</a>(<span class="keywordtype">int</span> iObs);
<a name="l00204"></a>00204     
<a name="l00205"></a>00205     <span class="keywordtype">void</span> <a class="code" href="classPSGP.html#240f5611079187e088207611912a95e6">stabiliseCoefficients</a>(<span class="keywordtype">double</span>&amp; q, <span class="keywordtype">double</span>&amp; r, <span class="keywordtype">double</span> cavityMean, <span class="keywordtype">double</span> cavityVar, <span class="keywordtype">double</span> upperTolerance, <span class="keywordtype">double</span> lowerTolerance);
<a name="l00206"></a>00206         vec <a class="code" href="classPSGP.html#2d1b2dc12932d1d760836104d2385e9b">scoreActivePoints</a>(<a class="code" href="PSGP_8h.html#b8070693104b4577c11a1c4e7573e2ca">ScoringMethod</a> sm);
<a name="l00207"></a>00207 
<a name="l00208"></a>00208         <span class="comment">// Parameter optimisation functions and their gradients</span>
<a name="l00209"></a>00209         <span class="keywordtype">double</span> <a class="code" href="classPSGP.html#77950366a61f5fc9d7a5ae976f053352">compEvidence</a>() <span class="keyword">const</span>;
<a name="l00210"></a>00210         <span class="keywordtype">double</span> <a class="code" href="classPSGP.html#da457213bb9cdc718b01c72a34c2fc51">compEvidenceApproximate</a>() <span class="keyword">const</span>;
<a name="l00211"></a>00211         <span class="keywordtype">double</span> <a class="code" href="classPSGP.html#867c40e09c7b271b2e7e551bb6769d85">compEvidenceUpperBound</a>() <span class="keyword">const</span>;
<a name="l00212"></a>00212         vec <a class="code" href="classPSGP.html#420424111c27f9c9144c4214ebb39d92">gradientEvidence</a>() <span class="keyword">const</span>;
<a name="l00213"></a>00213         vec <a class="code" href="classPSGP.html#5e7be52ab2c75520eef95619b50b7b5a">gradientEvidenceApproximate</a>() <span class="keyword">const</span>;
<a name="l00214"></a>00214         vec <a class="code" href="classPSGP.html#ca20bd35d418f8c0900e9a609b5b19fa">gradientEvidenceUpperBound</a>() <span class="keyword">const</span>;
<a name="l00215"></a>00215 
<a name="l00216"></a>00216         <span class="comment">// Numerical tools</span>
<a name="l00217"></a>00217         mat <a class="code" href="classPSGP.html#a5c4ba8a1486069b7b44567e799d7e1c">computeCholesky</a>(<span class="keyword">const</span> mat&amp; iM) <span class="keyword">const</span>;
<a name="l00218"></a>00218         mat <a class="code" href="classPSGP.html#4416eaa898c2f31de72d966f2265e148">computeInverseFromCholesky</a>(<span class="keyword">const</span> mat&amp; <a class="code" href="classPSGP.html#cf98a3926ff0c60b077bc26cebceb5c4">C</a>) <span class="keyword">const</span>;
<a name="l00219"></a>00219 };
<a name="l00220"></a>00220 
<a name="l00221"></a>00221 <span class="preprocessor">#endif </span><span class="comment">/*PSGP_H_*/</span>
</pre></div></div>
<hr size="1"><address style="text-align: right;"><small>Generated on Wed May 5 00:44:42 2010 for GPTK by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.6 </small></address>
</body>
</html>
